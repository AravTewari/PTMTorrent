# Modelhub Torrent

> Scripts to create the Modelhub component of the greater PTM-Torrent dataset

## Table of Contents

- [Modelhub Torrent](#modelhub-torrent)
  - [Table of Contents](#table-of-contents)
  - [About](#about)
  - [How to Run](#how-to-run)
    - [Through `__main__.py`](#through-__main__py)
    - [As Individual Files](#as-individual-files)
  - [Data Storage](#data-storage)
    - [Data Directory Specifics](#data-directory-specifics)
      - [`data/modelhub/html`](#datamodelhubhtml)
      - [`data/modelhub/json`](#datamodelhubjson)
      - [`data/modelhub/json/metadata`](#datamodelhubjsonmetadata)
      - [`data/modelhub/json/metadata/models`](#datamodelhubjsonmetadatamodels)
      - [`data/modelhub/repos`](#datamodelhubrepos)
  - [References](#references)

## About

This folder contains the scripts to download PTM repositories and extract
metadata for the greater *PTMTorrent* dataset from
[Modelhub](https://modelhub.ai).

To download the entirety of the [Modelhub](https://modelhub.ai) model hub
requires nGB of storage.

## How to Run

To run the scripts within this folder, the larger `ptm_torrent` project and its
dependencies must first be installed. See this project's root
[`README.md`](../../README.md) for more information.

### Through [`__main__.py`](__main__.py)

- `python __main__.py`

### As Individual Files

> This method assumes that you accept all of the default values of the scripts.
> Changes can be made manually within the scripts if the defualts are not
> acceptable for your use case.

1. `python setupFileSystem.py`
1. `python downloadJSON.py`
1. `python downloadRepos.py`
1. `python createSchema.py`

## Data Storage

> The following directory structure was taken on 1/25/2023. Files within the
> `data/modelhub/json/metadata/models` directory have been removed from the
> output to save space.

```shell
📦data
 ┗ 📂modelhub
 ┃ ┣ 📂html
 ┃ ┃ ┗ 📂metadata
 ┃ ┃ ┃ ┗ 📂models
 ┃ ┣ 📂json
 ┃ ┃ ┣ 📂metadata
 ┃ ┃ ┃ ┣ 📂models
 ┃ ┃ ┃ ┃ ┗ 📜*.json
 ┃ ┃ ┃ ┣ 📜mz_metadata.json
 ┃ ┃ ┃ ┗ 📜mz_models_metadata.json
 ┃ ┃ ┗ 📜modelzoo.json
 ┃ ┗ 📂repos
 ┃ ┃ ┣ 📂AUTHOR
 ┃ ┃ ┃ ┣ 📂MODEL
```

> This folder structure is generated relative to where the script is ran from.
> Example: if the script was ran from the home directory (`~`), then the `data`
> folder would be stored at `~/data`.

Where:

- data/modelhub/repos/`AUTHOR` is the author name of the repository that was
  cloned.
- data/modelhub/repos/AUTHOR/`MODEL` is the name of the repository that was
  cloned.

Model hub scripts do not overwrite the folder. In other words, it is a safe
operation to run multiple model hub scripts from the same directory sequentially
or concurrently.

### Data Directory Specifics

#### `data/modelhub/html`

This directory is not currently utilized by our scripts. It is kept within the
program for consistency across model hubs.

#### `data/modelhub/json`

This directory contains JSON files formatted to fit specific schemas.

The top level file (`modelhub.json`) is formatted to work with the general
[PTMTorrent JSON Schema](../utils/schemas/onnxmodelhubModelMetadata.json).

#### `data/modelhub/json/metadata`

This directory contains JSON files formatted to fit specific schemas.

The file (`mh_metadata.json`) is formatted to work with the
[Model Hub hub metadata JSON Schema](../utils/schemas/modelhubMetadata.json).

#### `data/modelhub/json/metadata/models`

This directory is not currently utilized by our scripts. It is kept within the
program for consistency across model hubs.

#### `data/modelhub/repos`

This directory contains the repository downloaded from the model hub.

Repositories are downloaded into this directory in the format `AUTHOR/REPO`.

Repositories paths are generated by taking the `git` compatible cloning URL and
parsing it for the model *author* and *owner*

> Example: <https://github.com/SoftwareSystemsLaboratory/PTM-Torrent> ->
> SoftwareSystemsLaboratory/PTM-Torrent

## References

> References are sorted by alphabetical order and not how they appear in this
> document.

\[1\] “Modelhub.” https://modelhub.ai/ (accessed Jan. 25, 2023).
